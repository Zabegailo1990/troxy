gsap.registerPlugin(ScrollTrigger);let iteration=0,spacing=.1,snap=gsap.utils.snap(spacing),cards=gsap.utils.toArray(".marquee__card"),seamlessLoop=buildSeamlessLoop(cards,spacing),scrub=gsap.to(seamlessLoop,{totalTime:0,duration:.5,ease:"power3",paused:!0}),trigger=ScrollTrigger.create({trigger:".home__section-marquee",start:"top top",end:"=+2000",pin:!0,onUpdate(e){1===e.progress&&0<e.direction&&!e.wrapping?wrapForward(e):e.progress<1e-5&&e.direction<0&&!e.wrapping?wrapBackward(e):(scrub.vars.totalTime=snap((iteration+e.progress)*seamlessLoop.duration()),scrub.invalidate().restart(),e.wrapping=!1)}});function wrapForward(e){iteration++,e.wrapping=!0,e.scroll(e.start+1)}function wrapBackward(e){--iteration<0&&(iteration=9,seamlessLoop.totalTime(seamlessLoop.totalTime()+10*seamlessLoop.duration()),scrub.pause()),e.wrapping=!0,e.scroll(e.end-1)}function scrubTo(e){e=(e-seamlessLoop.duration()*iteration)/seamlessLoop.duration();1<e?wrapForward(trigger):e<0?wrapBackward(trigger):trigger.scroll(trigger.start+e*(trigger.end-trigger.start))}function buildSeamlessLoop(e,r){let a=Math.ceil(1/r),t=e.length*r+.5,i=(e.length+a)*r+1,s=gsap.timeline({paused:!0}),o=gsap.timeline({paused:!0,repeat:-1,onRepeat(){this._time===this._dur&&(this._tTime+=this._dur-.01)}}),n=e.length+2*a,p,g,l;for(gsap.set(e,{xPercent:400,opacity:0,scale:0}),g=0;g<n;g++)l=e[g%e.length],p=g*r,s.fromTo(l,{scale:0,opacity:0},{scale:1,opacity:1,zIndex:100,duration:.5,yoyo:!0,repeat:1,ease:"power1.in",immediateRender:!1},p).fromTo(l,{xPercent:400},{xPercent:-400,duration:1,ease:"none",immediateRender:!1},p);return s.time(t),o.to(s,{time:i,duration:i-t,ease:"none"}).fromTo(s,{time:a*r+1},{time:t,duration:t-(a*r+1),immediateRender:!1,ease:"none"}),o}