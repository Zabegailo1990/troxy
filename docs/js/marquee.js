gsap.registerPlugin(ScrollTrigger);let iteration=0,spacing=.1,snap=gsap.utils.snap(spacing),cards=gsap.utils.toArray(".cards li"),seamlessLoop=buildSeamlessLoop(cards,spacing),scrub=gsap.to(seamlessLoop,{totalTime:0,duration:.5,ease:"power3",paused:!0}),trigger=ScrollTrigger.create({start:0,onUpdate(e){1===e.progress&&0<e.direction&&!e.wrapping?wrapForward(e):e.progress<1e-5&&e.direction<0&&!e.wrapping?wrapBackward(e):(scrub.vars.totalTime=snap((iteration+e.progress)*seamlessLoop.duration()),scrub.invalidate().restart(),e.wrapping=!1)},end:"+=3000",pin:".home__section-marquee"});function wrapForward(e){iteration++,e.wrapping=!0,e.scroll(e.start+1)}function wrapBackward(e){--iteration<0&&(iteration=9,seamlessLoop.totalTime(seamlessLoop.totalTime()+10*seamlessLoop.duration()),scrub.pause()),e.wrapping=!0,e.scroll(e.end-1)}function scrubTo(e){e=(e-seamlessLoop.duration()*iteration)/seamlessLoop.duration();1<e?wrapForward(trigger):e<0?wrapBackward(trigger):trigger.scroll(trigger.start+e*(trigger.end-trigger.start))}function buildSeamlessLoop(e,r){let a=Math.ceil(1/r),t=e.length*r+.5,s=(e.length+a)*r+1,i=gsap.timeline({paused:!0}),o=gsap.timeline({paused:!0,repeat:-1,onRepeat(){this._time===this._dur&&(this._tTime+=this._dur-.01)}}),n=e.length+2*a,p,l,c;for(gsap.set(e,{xPercent:400,opacity:0,scale:0}),l=0;l<n;l++)c=e[l%e.length],p=l*r,i.fromTo(c,{scale:0,opacity:0},{scale:1,opacity:1,zIndex:100,duration:.5,yoyo:!0,repeat:1,ease:"power1.in",immediateRender:!1},p).fromTo(c,{xPercent:400},{xPercent:-400,duration:1,ease:"none",immediateRender:!1},p),l<=e.length&&o.add("label"+l,p);return i.time(t),o.to(i,{time:s,duration:s-t,ease:"none"}).fromTo(i,{time:a*r+1},{time:t,duration:t-(a*r+1),immediateRender:!1,ease:"none"}),o}document.querySelector(".next").addEventListener("click",()=>scrubTo(scrub.vars.totalTime+spacing)),document.querySelector(".prev").addEventListener("click",()=>scrubTo(scrub.vars.totalTime-spacing));